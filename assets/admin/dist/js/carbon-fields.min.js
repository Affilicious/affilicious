!function e(t,i,a){function n(l,o){if(!i[l]){if(!t[l]){var s="function"==typeof require&&require;if(!o&&s)return s(l,!0);if(r)return r(l,!0);var d=new Error("Cannot find module '"+l+"'");throw d.code="MODULE_NOT_FOUND",d}var u=i[l]={exports:{}};t[l][0].call(u.exports,function(e){var i=t[l][1][e];return n(i||e)},u,u.exports,e,t,i,a)}return i[l].exports}for(var r="function"==typeof require&&require,l=0;l<a.length;l++)n(a[l]);return n}({1:[function(e,t,i){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}var n=e("./views/image-gallery"),r=a(n),l=e("./views/tags"),o=a(l);window.carbon=window.carbon||{},function(){var e=window.carbon;if(void 0===e.fields)return!1;e.fields.View.ImageGallery=r.default,e.fields.View.Tags=o.default}()},{"./views/image-gallery":2,"./views/tags":3}],2:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=carbon.fields.View.Image.extend({events:_.extend({},carbon.fields.View.prototype.events,{"click .c2_open_media":"openMedia","click .carbon-image-remove":"removeImage"}),initialize:function(){carbon.fields.View.prototype.initialize.apply(this),this.on("field:beforeRender",this.loadDescriptionTemplate),this.on("field:rendered",this.sortableImages),this.listenTo(this.model,"change:images",this.updateInput),this.listenTo(this.model,"change:value",this.render)},sortableImages:function(){var e=this,t=this.$("ul.carbon-image-gallery");t.sortable({items:"li.carbon-image",cursor:"move",helper:"clone",scrollSensitivity:42,forcePlaceholderSize:!0,opacity:.75,forceHelperSize:!1,placeholder:"carbon-sortable-placeholder",update:function(){var i=[];t.find("li.carbon-image").each(function(){var e=$(this),t=e.attr("data-image-value"),a=e.find("img").attr("src");i.push({value:t,url:a})}),e.model.set("images",i)}})},openMedia:function(e){var t=this,i=this.model.get("type"),a=(this.model.get("images"),this.model.get("window_button_label")),n=this.model.get("window_label"),r=this.model.get("type_filter"),l=this.model.get("value_type"),o={};o[i]=wp.media.frames.crbMediaField=wp.media({title:n||crbl10n.title,library:{type:r},button:{text:a},multiple:!0});var s=o[i];s.on("select",function(){var e=s.state().get("selection").toJSON(),i=_.clone(t.model.get("images"));_.each(e,function(e){i.push({value:e[l],url:e.url})}),t.model.set("images",i)}),s.open(),e.preventDefault()},updateInput:function(e){console.log(e);var t=this.$("input.carbon-image-gallery-field"),i=e.get("images"),a=_.map(i,function(e){return e.value}),n=a.join();t.val(n).trigger("change")},removeImage:function(e){for(var t=this.$(e.currentTarget),i=t.parents("ul.carbon-image-gallery").children(),a=t.parents("li.carbon-image"),n=_.clone(this.model.get("images")),r=i.index(a),l=[],o=0;o<n.length;o++)o!=r&&l.push(n[o]);this.model.set("images",l)}})},{}],3:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=carbon.fields.View.extend({initialize:function(){carbon.fields.View.prototype.initialize.apply(this),this.on("field:rendered",this.initField)},initField:function(){var e=this,t=this.model.get("tags"),i=this.model.get("maxItems");if(t){var a=Object.keys(t).map(function(e){return{id:e,text:t[e]}});this.$el.find(".aff-tags.aff-tags-predefined").selectize({plugins:["drag_drop","remove_button"],delimiter:",",persist:!0,create:!0,valueField:"id",labelField:"text",maxOptions:10,searchField:["text"],maxItems:i,options:a,onChange:function(){e.model.set("value",e.$el.find('input[name="'+e.templateVariables.name+'"]').val())}})}else this.$el.find(".aff-tags.aff-tags-custom").selectize({plugins:["drag_drop","remove_button"],delimiter:",",persist:!0,maxItems:i,create:!0,onChange:function(){e.model.set("value",e.$el.find('input[name="'+e.templateVariables.name+'"]').val())}})}})},{}]},{},[1]);