!function e(t,i,n){function a(o,s){if(!i[o]){if(!t[o]){var l="function"==typeof require&&require;if(!s&&l)return l(o,!0);if(r)return r(o,!0);var d=new Error("Cannot find module '"+o+"'");throw d.code="MODULE_NOT_FOUND",d}var u=i[o]={exports:{}};t[o][0].call(u.exports,function(e){var i=t[o][1][e];return a(i||e)},u,u.exports,e,t,i,n)}return i[o].exports}for(var r="function"==typeof require&&require,o=0;o<n.length;o++)a(n[o]);return a}({1:[function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var a=e("./views/image-gallery"),r=n(a),o=e("./views/tags"),s=n(o);window.carbon=window.carbon||{},function(){var e=window.carbon;if(void 0===e.fields)return!1;e.fields.View.ImageGallery=r.default,e.fields.View.Tags=s.default}()},{"./views/image-gallery":2,"./views/tags":3}],2:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=carbon.fields.View.Image.extend({events:_.extend({},carbon.fields.View.prototype.events,{"click .c2_open_media":"openMedia","click .carbon-image-remove":"removeImage"}),initialize:function(){carbon.fields.View.prototype.initialize.apply(this),this.on("field:beforeRender",this.loadDescriptionTemplate),this.on("field:rendered",this.sortableImages),this.listenTo(this.model,"change:images",this.updateInput),this.listenTo(this.model,"change:value",this.render)},sortableImages:function(){var e=this,t=this.$("ul.carbon-image-gallery");t.sortable({items:"li.carbon-image",cursor:"move",helper:"clone",scrollSensitivity:42,forcePlaceholderSize:!0,opacity:.75,forceHelperSize:!1,placeholder:"carbon-sortable-placeholder",update:function(){var i=[];t.find("li.carbon-image").each(function(){var e=$(this),t=e.attr("data-image-value"),n=e.find("img").attr("src");i.push({value:t,url:n})}),e.model.set("images",i)}})},openMedia:function(e){var t=this,i=this.model.get("type"),n=(this.model.get("images"),this.model.get("window_button_label")),a=this.model.get("window_label"),r=this.model.get("type_filter"),o=this.model.get("value_type"),s={};s[i]=wp.media.frames.crbMediaField=wp.media({title:a||crbl10n.title,library:{type:r},button:{text:n},multiple:!0});var l=s[i];l.on("select",function(){var e=l.state().get("selection").toJSON(),i=_.clone(t.model.get("images"));_.each(e,function(e){i.push({value:e[o],url:e.url})}),t.model.set("images",i)}),l.open(),e.preventDefault()},updateInput:function(e){console.log(e);var t=this.$("input.carbon-image-gallery-field"),i=e.get("images"),n=_.map(i,function(e){return e.value}),a=n.join();t.val(a).trigger("change")},removeImage:function(e){for(var t=this.$(e.currentTarget),i=t.parents("ul.carbon-image-gallery").children(),n=t.parents("li.carbon-image"),a=_.clone(this.model.get("images")),r=i.index(n),o=[],s=0;s<a.length;s++)s!=r&&o.push(a[s]);this.model.set("images",o)}})},{}],3:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=carbon.fields.View.extend({initialize:function(){carbon.fields.View.prototype.initialize.apply(this),this.on("field:rendered",this._initTags),this.listenTo(this.model,"change:visible",this._initTags)},_initTags:function(){var e=this.model.get("tags"),t=this.model.get("maxItems");e?this._initPredefinedTags(e,t):this._initCustomTags(t)},_initPredefinedTags:function(e,t){var i=this,n=this.$el.find(".aff-tags-predefined"),a=n[0].selectize,r=Object.keys(e).map(function(t){return{id:t,text:e[t]}});a?a.enable():n.selectize({plugins:["drag_drop","remove_button"],delimiter:",",persist:!0,create:!0,valueField:"id",labelField:"text",maxOptions:10,searchField:["text"],maxItems:t,options:r,onChange:function(){return i._onChangeTags()}})},_initCustomTags:function(e){var t=this,i=this.$el.find(".aff-tags-custom"),n=i[0].selectize;n?n.enable():i.selectize({plugins:["drag_drop","remove_button"],delimiter:",",persist:!0,maxItems:e,create:!0,onChange:function(){return t._onChangeTags()}})},_onChangeTags:function(){var e=this.$el.find('input[name="'+this.templateVariables.name+'"]');this.model.set("value",e.val())}});i.default=n},{}]},{},[1]);